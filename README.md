# 鼻歌ピッチ検出プロトタイプ

ブラウザだけでマイク入力の音程を検出し、音名・MIDI・信頼度をリアルタイム表示する簡易プロトタイプです。音声は端末内で処理され、外部に送信しません。

## 使い方
1. ローカルで静的サーバーを立ち上げる（`file://` では AudioWorklet が動かないため http/https が必須）
   - 例: `python -m http.server 8000` をリポジトリ直下で実行し、`http://localhost:8000/index.html` を開く。
2. ブラウザ（Chrome/Edge/Safari 推奨）でページを開き、「開始」をクリックしてマイク許可を与える。
3. マイクに向かって鼻歌/声を出すと、推定周波数・MIDI・信頼度・音階が更新されます。
4. 終了するときは「停止」をクリック。音声はゼロゲインに接続しているためスピーカーには出ません。

## トラブルシュート
- 「開始」を押しても動かない: セキュアコンテキスト (https または localhost) で開いているか確認。マイク許可を拒否していないかブラウザ設定を確認。
- Worklet 読み込みエラー: ローカルサーバーが正しく起動しているか、また拡張機能などでリクエストがブロックされていないか確認。フォールバックとして ScriptProcessor が使われますが遅延は増えます。
- 反応が弱い: マイク入力レベルを上げる、マイクに近づく、ノイズ抑制などを一時的にオフにする。

## 主な仕様
- ピッチ検出: YIN ベースの実装（AudioWorklet 優先、非対応環境では ScriptProcessor にフォールバック）
- 音域想定: 80–800 Hz を主にターゲット
- 平滑化: 直近サンプルの単純移動平均で揺れを低減
- プライバシー: 音声データはブラウザ内完結で外部送信しません

## 開発メモ
- 本プロトタイプは `index.html` のみで構成され、追加ビルドステップは不要です。
- コードはインラインの ES Modules と AudioWorklet を利用しています。*** End Patch버
